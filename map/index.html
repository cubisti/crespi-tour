
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/96/three.min.js"></script>
<script src=http://mrdoob.github.io/three.js/examples/js/controls/FirstPersonControls.js ></script>
<script src="http://threejs.org/examples/js/renderers/CSS3DRenderer.js"></script>
<script src="https://cdn.rawgit.com/mrdoob/three.js/r69/examples/js/loaders/ColladaLoader.js"></script>
<script src="https://cdn.rawgit.com/mrdoob/three.js/r85/examples/js/loaders/GLTF2Loader.js"></script>
<script src="https://threejs.org/examples/js/controls/MapControls.js"></script>
<meta type="no-cache"
<html>
	<head>
		<title>.</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
	</body>
	<script>
	var renderer,
	scene,
	camera,
	controls,
	mouseVector = new THREE.Vector3(),
	diamond1,
	clock = new THREE.Clock(),
	diamondTexture;
	const button = new THREE.Group();
init();
animate();
/*
TODO
CHANGE LIGHT
Raycaster

*/
function initializingSpace() {
renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

scene = new THREE.Scene();
scene.background = new THREE.Color(0xffffff);

camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.target = new THREE.Vector3(0, 0, 0);
//last one is fov
camera.position.set(0, 40, 0);
scene.add(camera);

//controls
controls = new THREE.MapControls(camera, renderer.domElement);
controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled
controls.dampingFactor = 0.25;
controls.screenSpacePanning = false;
controls.minDistance = 70;
controls.maxDistance = 100;
controls.minPolarAngle = Math.PI / 6;
controls.maxPolarAngle = Math.PI / 3;


var light = new THREE.AmbientLight(0xffffff);
	button.add(light);
}

function loadMap(){
const mapLoader = new THREE.GLTF2Loader();
const mapDir = "3d/crespi3d.gltf";
mapLoader.load(mapDir, function(data) {
	gltf = data;
	scene.add(gltf.scene);
	gltf.animations;
	gltf.scene;
	gltf.cameras;
	gltf.asset;
});

}
function createButton() {
	var geometry = new THREE.SphereGeometry(10, 2, 100);
	var material = new THREE.MeshNormalMaterial();
	diamond1 = new THREE.Mesh(geometry, material);
	diamond1.position.set(0, 30, 0);
	button.add(diamond1);
	scene.add(button);
}
function init() {
initializingSpace();
loadMap();
createButton();
window.addEventListener('resize', onWindowResize, false);
window.addEventListener("click", onClick);
}
function onWindowResize() {
camera.aspect = window.innerWidth / window.innerHeight;
renderer.setSize( window.innerWidth, window.innerHeight );
controls.handleResize();
}


function onClick(e) {
var mouse = new THREE.Vector2(
	(e.clientX / window.innerWidth) * 2 - 1,
	- (e.clientY / window.innerHeight) * 2 + 1
);
var raycaster = new THREE.Raycaster();
raycaster.setFromCamera(mouse, camera);
var intersects = raycaster.intersectObject(button);
	if(intersects.lenght > 0) {
		console.log("hello");
	}
}

function animate() {
controls.update(clock.getDelta());
renderer.render(scene, camera);
requestAnimationFrame(animate);
}
	</script>
</html>
